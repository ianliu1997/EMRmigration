<UserControl xmlns:toolkit="http://schemas.microsoft.com/winfx/2006/xaml/presentation/toolkit" 
    x:Class="PalashDynamics.Pharmacy.MaterialConsumption"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
              xmlns:Grp="clr-namespace:Groupbox;assembly=Groupbox"
             xmlns:data="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Data"
             xmlns:controls="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls"
             xmlns:inputcombo="clr-namespace:PalashDynamics.Controls;assembly=PalashDynamics.Controls.AutoCompleteComboBox"
              xmlns:converter="clr-namespace:PalashDynamics.Converters;assembly=PalashDynamics.Converters" 
    mc:Ignorable="d" Width="Auto" Height="Auto" Loaded="UserControl_Loaded" >
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/PalashDynamics;component/Generic.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            <converter:DateTimeConverter x:Key="DateConverter" />
        </ResourceDictionary>
    </UserControl.Resources>

    <toolkit:DockPanel LastChildFill="True">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition></ColumnDefinition>
                <ColumnDefinition></ColumnDefinition>
            </Grid.ColumnDefinitions>
            <toolkit:DockPanel Grid.Column="0" Grid.ColumnSpan="2" HorizontalAlignment="Stretch"  Visibility="Visible"  LastChildFill="True" x:Name="FrontPanel">
                <toolkit:DockPanel toolkit:DockPanel.Dock="Bottom" HorizontalAlignment="Right">
                    <StackPanel Grid.Column="1" Margin="4" Grid.Row="1" Grid.ColumnSpan="2" Orientation="Horizontal">
                        <ToggleButton Background="#000000" Margin="5,0,0,0" HorizontalAlignment="Stretch" Style="{StaticResource ToggleButtonStyle}" Visibility="Visible"  Content="New"   x:Name="cmdNew" Click="cmdNew_Click" ></ToggleButton>
                        <ToggleButton Background="#000000" Margin="5,0,0,0" HorizontalAlignment="Stretch" Style="{StaticResource ToggleButtonStyle}" Visibility="Visible" Content="Print"   x:Name="cmdPrint" Click="cmdPrint_Click" ></ToggleButton>
                        <ToggleButton Background="#000000" Margin="5,0,0,0" HorizontalAlignment="Stretch" Style="{StaticResource ToggleButtonStyle}" Visibility="Collapsed" Content="Close"   x:Name="cmdCloseM" Click="cmdCloseM_Click" ></ToggleButton>

                        <!--<ToggleButton Background="#000000" Margin="5,0,0,0" HorizontalAlignment="Stretch" Style="{StaticResource ToggleButtonStyle}" Visibility="Visible" Content="Save"   x:Name="cmdSave" IsEnabled="False" ></ToggleButton>
                        <ToggleButton Background="#000000" Margin="5,0,0,0" HorizontalAlignment="Stretch" Style="{StaticResource ToggleButtonStyle}" Visibility="Visible" Content="Print"   x:Name="cmdPrint" IsEnabled="False"></ToggleButton>-->
                       
                    </StackPanel>
                </toolkit:DockPanel>
                <toolkit:DockPanel LastChildFill="True">
                    <!--Material Consumption List-->
                    <Border  toolkit:DockPanel.Dock="Top" BorderBrush="{StaticResource TabControlDarkerBorder}"   BorderThickness="1" CornerRadius="3,3,0,0" Background="Transparent">
                        <ContentControl VerticalAlignment="Center" Grid.ColumnSpan="4" FontSize="12" Content="List of Material Consumption" Margin="-1" Style="{StaticResource Header}"     HorizontalAlignment="Stretch" />
                    </Border>
                    <Border BorderBrush="{StaticResource TabControlDarkerBorder}"  Margin="0,-1,0,0" BorderThickness="1" CornerRadius="0,0,3,3" Background="Transparent">
                        <toolkit:DockPanel  LastChildFill="True">
                            <toolkit:DockPanel x:Name="dpSearch1" toolkit:DockPanel.Dock="Top" LastChildFill="True">
                                <Grp:GroupBox Header="Material Consumption Search" toolkit:DockPanel.Dock="Top">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition ></RowDefinition>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"></ColumnDefinition>
                                            <ColumnDefinition></ColumnDefinition>
                                            <ColumnDefinition Width="Auto" ></ColumnDefinition>
                                            <ColumnDefinition  ></ColumnDefinition>
                                            <ColumnDefinition Width="Auto" ></ColumnDefinition>
                                            <ColumnDefinition  ></ColumnDefinition>
                                            <ColumnDefinition  ></ColumnDefinition>
                                        </Grid.ColumnDefinitions>




                                        <TextBlock Text="From Date" Margin="2" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" ></TextBlock>
                                        <controls:DatePicker x:Name="dpSearchFromDate" Margin="2" Grid.Row="0" Grid.Column="1"  HorizontalAlignment="Stretch" VerticalAlignment="Center" ></controls:DatePicker>

                                        <TextBlock Text="To Date" Margin="2" Grid.Row="0" Grid.Column="2" VerticalAlignment="Center"></TextBlock>
                                        <controls:DatePicker x:Name="dpSearchToDate" Margin="2" Grid.Row="0" Grid.Column="3"  HorizontalAlignment="Stretch" VerticalAlignment="Center" ></controls:DatePicker>

                                        <TextBlock Grid.Row="0" Grid.Column="4" Text="Store" Margin="2" VerticalAlignment="Center"></TextBlock>
                                        <inputcombo:AutoCompleteComboBox  SelectedItemBinding="{Binding clsStoreVO, Mode=OneWay}" SelectedValuePath="StoreId" Margin="2"  Grid.Row="0" Grid.Column="5"   x:Name="cmbSearchStore" VerticalAlignment="Center"  ></inputcombo:AutoCompleteComboBox>

                                        <StackPanel HorizontalAlignment="Left" VerticalAlignment="Bottom" Grid.Row="0" Grid.Column="6" Margin="4"   Orientation="Horizontal">
                                            <!--<ToggleButton  Background="#000000" Margin="4" HorizontalAlignment="Left" Style="{StaticResource ToggleButtonStyle}" Visibility="Visible" Content="Search" Width="80"   x:Name="cmdSearch"  Click="cmdSearch_Click" ></ToggleButton>-->
                                            <Button x:Name="cmdSearch" Margin="4" ToolTipService.ToolTip="Search Material Consumption" Click="cmdSearch_Click">
                                                <Image Source="/PalashDynamics;component/Icons/Search_b.JPG" Margin="4" Width="20" ></Image>
                                            </Button>
                                        </StackPanel>

                                    </Grid>
                                </Grp:GroupBox>
                            </toolkit:DockPanel>
                            <toolkit:DockPanel LastChildFill="True" x:Name="dpMaterialConsumptionList">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition></RowDefinition>
                                        <RowDefinition></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <toolkit:DockPanel Grid.Row="0" LastChildFill="True" x:Name="dpItemListTop">
                                        <data:DataPager x:Name="dpdgMaterailConsumptionList" toolkit:DockPanel.Dock="Bottom" 
                                                        DisplayMode="FirstLastPreviousNext"  IsEnabled="True"                       
                                                        Source="{Binding}" 
                                                        AutoEllipsis="False" IsTotalItemCountFixed="False" Margin="4,0,4,0"  />
                                        <data:DataGrid   x:Name="dgMaterailConsumptionList" ScrollViewer.HorizontalScrollBarVisibility="auto" ScrollViewer.VerticalScrollBarVisibility="auto" AutoGenerateColumns="False"  AlternatingRowBackground="Silver" VerticalAlignment="Stretch"  Margin="4,4,4,2" SelectionChanged="dgMaterailConsumptionList_SelectionChanged" >
                                            <data:DataGrid.Columns>
                                                <!--<data:DataGridTextColumn IsReadOnly="True"  Header="Material Consumption Number"  Binding="{Binding ConsumptionNo,Mode=TwoWay}"></data:DataGridTextColumn>-->
                                                <data:DataGridTextColumn Visibility="Visible" IsReadOnly="True"  Header="Consumption Date"  Binding="{Binding Date,Mode=TwoWay,Converter={StaticResource DateConverter},ConverterParameter='dd/MMM/yyyy hh:mm:ss'}"></data:DataGridTextColumn>
                                                <data:DataGridTextColumn Visibility="Visible"  IsReadOnly="True" Header="Store"  Binding="{Binding StoreName,Mode=TwoWay}"></data:DataGridTextColumn>
                                                <data:DataGridTextColumn IsReadOnly="True" Header="Total Items"  Binding="{Binding TotalItems,StringFormat=0.00,Mode=OneWay}">
                                                    <data:DataGridTextColumn.ElementStyle>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="TextAlignment" Value="Right"/>
                                                        </Style>
                                                    </data:DataGridTextColumn.ElementStyle>
                                                </data:DataGridTextColumn>
                                                <data:DataGridTextColumn IsReadOnly="True" Header="Total Amount"  Binding="{Binding TotalAmount,StringFormat=0.00,Mode=TwoWay}">
                                                    <data:DataGridTextColumn.ElementStyle>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="TextAlignment" Value="Right"/>
                                                        </Style>
                                                    </data:DataGridTextColumn.ElementStyle>
                                                </data:DataGridTextColumn>
                                                <data:DataGridTextColumn IsReadOnly="True" Header="Remark"  Binding="{Binding Remark,Mode=TwoWay}"></data:DataGridTextColumn>
                                                
                                                <data:DataGridTextColumn IsReadOnly="True" Header="Bill No"  Binding="{Binding BillNo,Mode=TwoWay}" Visibility="Collapsed" ></data:DataGridTextColumn>
                                                <data:DataGridTextColumn Visibility="Collapsed" IsReadOnly="True"  Header="Bill Date"  Binding="{Binding BillDate,Mode=TwoWay,Converter={StaticResource DateConverter},ConverterParameter='dd/MMM/yyyy'}"></data:DataGridTextColumn>

                                                <data:DataGridTextColumn IsReadOnly="True" Header="Total Bill Amount"  Binding="{Binding TotalBillAmount,StringFormat=0.00,Mode=TwoWay}" Visibility="Collapsed">
                                                    <data:DataGridTextColumn.ElementStyle>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="TextAlignment" Value="Right"/>
                                                        </Style>
                                                    </data:DataGridTextColumn.ElementStyle>
                                                </data:DataGridTextColumn>

                                                <data:DataGridTextColumn IsReadOnly="True" Header="Patient Name" Visibility="Visible" Binding="{Binding PatientName,Mode=TwoWay}"></data:DataGridTextColumn>
                                               
                                                <data:DataGridTemplateColumn Header="Is IPD" Visibility="Visible">
                                                    <data:DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <CheckBox x:Name="chkPatient" IsChecked="{Binding Path=Opd_Ipd_External,Mode=TwoWay}" IsEnabled="False"  VerticalAlignment="Center" HorizontalAlignment="Center" Width="Auto" ></CheckBox>
                                                        </DataTemplate>
                                                    </data:DataGridTemplateColumn.CellTemplate>
                                                </data:DataGridTemplateColumn>

                                                <data:DataGridTextColumn IsReadOnly="True" Header="Package Name" Visibility="Visible" Binding="{Binding PackageName,Mode=TwoWay}"></data:DataGridTextColumn>

                                            </data:DataGrid.Columns>
                                        </data:DataGrid>
                                    </toolkit:DockPanel>

                                    <toolkit:DockPanel Grid.Row="1" LastChildFill="True" x:Name="dpItemListBottom">
                                        <data:DataGrid  x:Name="dgMaterailConsumptionItemList" ScrollViewer.HorizontalScrollBarVisibility="auto" ScrollViewer.VerticalScrollBarVisibility="auto" AutoGenerateColumns="False"  AlternatingRowBackground="Silver" VerticalAlignment="Stretch"  Margin="4"     >
                                            <data:DataGrid.Columns>

                                                <data:DataGridTextColumn Visibility="Visible" IsReadOnly="True"  Header="Item Name"  Binding="{Binding ItemName,Mode=TwoWay}"></data:DataGridTextColumn>
                                                <data:DataGridTextColumn IsReadOnly="True"  Header="Batch Code"  Binding="{Binding BatchCode,Mode=TwoWay}"></data:DataGridTextColumn>
                                                <data:DataGridTextColumn IsReadOnly="True" Header="Expiry Date"  Binding="{Binding ExpiryDate,Mode=TwoWay,Converter={StaticResource DateConverter},ConverterParameter={StaticResource ExpiryDateDisplayFormat}}"></data:DataGridTextColumn>


                                                <!--<data:DataGridTextColumn IsReadOnly="True" Header="Available Stock"  Binding="{Binding AvailableStock,Mode=TwoWay}"></data:DataGridTextColumn>-->
                                                <!--<data:DataGridTextColumn Header="Issue Qnt"  Binding="{Binding IssueQty,Mode=TwoWay}"></data:DataGridTextColumn>-->
                                                <data:DataGridTemplateColumn Header="Used Quantity" IsReadOnly="True">
                                                    <data:DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <TextBlock  VerticalAlignment="Center" Text="{Binding UsedQty,StringFormat=0.00,Mode=TwoWay}" TextAlignment="Right"  ></TextBlock>

                                                        </DataTemplate>
                                                    </data:DataGridTemplateColumn.CellTemplate>
                                                </data:DataGridTemplateColumn>
                                                <data:DataGridTextColumn IsReadOnly="True"  Header="UOM"  Binding="{Binding TransactionUOM,Mode=TwoWay}"></data:DataGridTextColumn>


                                                <data:DataGridTextColumn  IsReadOnly="True" Header="Cost Price"  Binding="{Binding Rate,StringFormat=0.00,Mode=TwoWay}">
                                                    <data:DataGridTextColumn.ElementStyle>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="TextAlignment" Value="Right"/>
                                                        </Style>
                                                    </data:DataGridTextColumn.ElementStyle>
                                                </data:DataGridTextColumn>
                                                <data:DataGridTextColumn  IsReadOnly="True" Header="MRP Price"  Binding="{Binding MRP,StringFormat=0.00,Mode=TwoWay}">
                                                    <data:DataGridTextColumn.ElementStyle>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="TextAlignment" Value="Right"/>
                                                        </Style>
                                                    </data:DataGridTextColumn.ElementStyle>
                                                </data:DataGridTextColumn>
                                                <data:DataGridTextColumn IsReadOnly="True" Header="Total Amount"  Binding="{Binding Amount,StringFormat=0.00,Mode=TwoWay}">
                                                    <data:DataGridTextColumn.ElementStyle>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="TextAlignment" Value="Right"/>
                                                        </Style>
                                                    </data:DataGridTextColumn.ElementStyle>
                                                </data:DataGridTextColumn>
                                                <data:DataGridTextColumn IsReadOnly="True" Header="Remark"  Binding="{Binding Remark,Mode=TwoWay}">

                                                </data:DataGridTextColumn>


                                            </data:DataGrid.Columns>
                                        </data:DataGrid>
                                    </toolkit:DockPanel>
                                </Grid>
                            </toolkit:DockPanel>
                        </toolkit:DockPanel>
                    </Border>
                </toolkit:DockPanel>
            </toolkit:DockPanel>
            <toolkit:DockPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2"  HorizontalAlignment="Stretch"  Visibility="Collapsed"  LastChildFill="True"  x:Name="BackPanel" >
                <toolkit:DockPanel toolkit:DockPanel.Dock="Bottom" HorizontalAlignment="Right">
                    <StackPanel  Margin="4"  Grid.ColumnSpan="2" Orientation="Horizontal">
                        <ToggleButton Background="#000000" Margin="5,0,0,0" HorizontalAlignment="Stretch" Style="{StaticResource ToggleButtonStyle}" Visibility="Visible" Content="Save"   x:Name="cmdSave" IsEnabled="False" Click="cmdSave_Click" ></ToggleButton>
                        <ToggleButton Background="#000000" Margin="5,0,0,0" HorizontalAlignment="Stretch" Style="{StaticResource ToggleButtonStyle}" Visibility="Visible" Content="Close"   x:Name="cmdClose" IsEnabled="False" Click="cmdClose_Click"></ToggleButton>
                    </StackPanel>
                </toolkit:DockPanel>
                <toolkit:DockPanel  LastChildFill="True">
                    <toolkit:DockPanel x:Name="dpSummary" toolkit:DockPanel.Dock="Bottom" LastChildFill="True">
                        <Grp:GroupBox>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"></RowDefinition>
                                <RowDefinition Height="Auto"></RowDefinition>
                                <RowDefinition Height="Auto"></RowDefinition>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"></ColumnDefinition>
                                <ColumnDefinition></ColumnDefinition>
                                <ColumnDefinition Width="Auto"></ColumnDefinition>
                                <ColumnDefinition ></ColumnDefinition>
                                <ColumnDefinition Width="Auto"></ColumnDefinition>
                                <ColumnDefinition ></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Total Quantity" Margin="2" ></TextBlock>
                                <TextBox Margin="2" Grid.Row="0" Grid.Column="1" MaxLength="10" IsReadOnly="True" x:Name="txtNoOfItems"  TextAlignment="Right" Text="{Binding StringFormat=0.00}"></TextBox>

                            <TextBlock Grid.Row="0" Grid.Column="2" Text="Total Amount" Margin="2" ></TextBlock>
                                <TextBox Margin="2"  Grid.Row="0" Grid.Column="3 " MaxLength="50" IsReadOnly="True" x:Name="txtTotalAmount"  TextAlignment="Right" Text="{Binding StringFormat=0.00}"></TextBox>

                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Remark" Margin="2" ></TextBlock>
                                <TextBox Margin="2"  Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="1"  x:Name="txtRemark" Height="50" VerticalScrollBarVisibility="Visible" TextWrapping="Wrap"></TextBox>
                        </Grid>
                        </Grp:GroupBox>
                    </toolkit:DockPanel>
                    <toolkit:DockPanel LastChildFill="True" x:Name="dpItemList">
                        <toolkit:DockPanel x:Name="dpSearch" toolkit:DockPanel.Dock="Top" LastChildFill="True">
                            <Grp:GroupBox>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition ></RowDefinition>
                                        <RowDefinition ></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"></ColumnDefinition>
                                        <ColumnDefinition ></ColumnDefinition>
                                        <ColumnDefinition Width="Auto" ></ColumnDefinition>
                                        <ColumnDefinition  ></ColumnDefinition>
                                        <ColumnDefinition Width="150" ></ColumnDefinition>
                                        <ColumnDefinition ></ColumnDefinition>
                                        <ColumnDefinition Width="Auto"></ColumnDefinition>
                                        <ColumnDefinition Width="Auto"></ColumnDefinition>

                                    </Grid.ColumnDefinitions>

                                    <TextBlock Text="Date" Margin="4" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" ></TextBlock>
                                    <controls:DatePicker x:Name="dpConsumptionDate" Margin="4" Grid.Column="1"  VerticalAlignment="Center" HorizontalAlignment="Stretch" ></controls:DatePicker>

                                    <TextBlock Grid.Row="0" Grid.Column="2" Text="Store" Margin="4" VerticalAlignment="Center"></TextBlock>
                                    <inputcombo:AutoCompleteComboBox  SelectedItemBinding="{Binding clsStoreVO, Mode=OneWay}" SelectedValuePath="StoreId" Margin="4"  Grid.Row="0" Grid.Column="3"   x:Name="cmbStore" VerticalAlignment="Center" SelectionChanged="cmbStore_SelectionChanged"  ></inputcombo:AutoCompleteComboBox>
                                    <CheckBox  Margin="4" x:Name="chkAgainstPatient" Content="Against Patient" VerticalAlignment="Center" HorizontalAlignment="Right" Width="Auto" Grid.Column="4" Click="chkAgainstPatient_Click" ></CheckBox>
                                    


                                    <TextBlock Visibility="Collapsed"  Text="Bar Code" Grid.Row="1" Grid.Column="0" VerticalAlignment="Center"  Margin="4" />
                                    <TextBox Visibility="Collapsed" x:Name="txtBarCode" Grid.Row="1" Grid.Column="1" Margin="2,4" VerticalAlignment="Center" HorizontalAlignment="Stretch"  KeyUp="txtBarCode_KeyUp" TextAlignment="Right" Width="230" />

                                    <TextBlock VerticalAlignment="Center" HorizontalAlignment="Right" Text="MR No." Grid.Row="1" Grid.Column="2" Margin="4" ></TextBlock>
                                    <TextBox Grid.Row="1" Grid.Column="3" Margin="4" x:Name="txtMRNo" HorizontalAlignment="Stretch"  IsReadOnly="True"></TextBox>

                                    <TextBlock VerticalAlignment="Center" HorizontalAlignment="Right" Text="Patient Name" Grid.Row="1" Grid.Column="0" Margin="4" ></TextBlock>
                                    <TextBox Grid.Row="1" Grid.Column="1" Margin="4" x:Name="txtPatientName"  HorizontalAlignment="Stretch"  IsReadOnly="True"></TextBox>

                                    <TextBlock VerticalAlignment="Center" HorizontalAlignment="Right" Text="Patient Package" Grid.Row="1" Grid.Column="4" Margin="4" ></TextBlock>
                                    <inputcombo:AutoCompleteComboBox SelectedItemBinding="{Binding MasterListItem, Mode=OneWay}" SelectedValuePath="ID" Margin="4" Grid.Row="1" Grid.Column="5" 
                                                     x:Name="cmbApplicabelPackage" VerticalAlignment="Center" SelectionChanged="cmbApplicabelPackage_SelectionChanged"></inputcombo:AutoCompleteComboBox>
                                    
                                    <StackPanel Orientation="Horizontal" Grid.Column="5" Grid.Row="0" >
                                    <Button x:Name="btnSearchCriteria" HorizontalAlignment="Left" Margin="4" IsEnabled="False" VerticalAlignment="Center" Grid.Column="5" ToolTipService.ToolTip="Find Patient" Click="btnSearchCriteria_Click" >
                                        <Button.Content>
                                            <Image Source="/PalashDynamics;component/Icons/xmag.png" Margin="2" Width="20" ></Image>
                                        </Button.Content>
                                    </Button>

                                        <ToggleButton Margin="4" Grid.Column="5" x:Name="cmdAddItem"  Content="Add Item"  Background="#000000" HorizontalAlignment="Right" Style="{StaticResource ToggleButtonStyle}" Visibility="Visible" VerticalAlignment="Center" Click="cmdAddItem_Click"/>
                                    </StackPanel>
                                </Grid>

                            </Grp:GroupBox>
                           
                        </toolkit:DockPanel>
                        <toolkit:DockPanel LastChildFill="True" x:Name="dpItemListHeader">
                            <data:DataGrid  x:Name="dgItemList" ScrollViewer.HorizontalScrollBarVisibility="auto" ScrollViewer.VerticalScrollBarVisibility="auto" AutoGenerateColumns="False"  AlternatingRowBackground="Silver" VerticalAlignment="Stretch"  Margin="4"   CanUserSortColumns="False" CellEditEnded="dgItemList_CellEditEnded">
                                <data:DataGrid.Columns>

                                    <data:DataGridTextColumn Visibility="Visible" IsReadOnly="True"  Header="Item Name"  Binding="{Binding ItemName,Mode=TwoWay}"></data:DataGridTextColumn>
                                    <data:DataGridTextColumn IsReadOnly="True"  Header="Batch Code"  Binding="{Binding BatchCode,Mode=TwoWay}"></data:DataGridTextColumn>
                                    <data:DataGridTextColumn IsReadOnly="True" Header="Expiry Date"  Binding="{Binding ExpiryDate,Mode=TwoWay,Converter={StaticResource DateConverter},ConverterParameter={StaticResource ExpiryDateDisplayFormat}}"></data:DataGridTextColumn>


                                    <data:DataGridTextColumn IsReadOnly="True" Header="Available Stock"  Binding="{Binding AvailableStock,StringFormat=0.00,Mode=TwoWay}">
                                        <data:DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="TextAlignment" Value="Right"/>
                                            </Style>
                                        </data:DataGridTextColumn.ElementStyle>
                                    </data:DataGridTextColumn>
                                    <!--<data:DataGridTextColumn Header="Issue Qnt"  Binding="{Binding IssueQty,Mode=TwoWay}"></data:DataGridTextColumn>-->
                                    <data:DataGridTemplateColumn Header="Used Quantity">
                                        <data:DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock  VerticalAlignment="Center" Text="{Binding UsedQty,StringFormat=0.00,Mode=TwoWay}" TextAlignment="Right"></TextBlock>
                                            </DataTemplate>


                                        </data:DataGridTemplateColumn.CellTemplate>
                                        <data:DataGridTemplateColumn.CellEditingTemplate>
                                            <DataTemplate>
                                                <TextBox x:Name="txtUsedQty" Text="{Binding UsedQty,Mode=TwoWay}" MaxLength="5" TextAlignment="Right" KeyDown="txtNumber_KeyDown"></TextBox>
                                            </DataTemplate>
                                        </data:DataGridTemplateColumn.CellEditingTemplate>
                                    </data:DataGridTemplateColumn>
                                    <!--By Umesh-->

                                    <data:DataGridTemplateColumn Header="UOM">
                                        <data:DataGridTemplateColumn.CellTemplate >
                                            <DataTemplate>
                                                <!--<inputcombo:AutoCompleteComboBox Width="100"  x:Name="cmbPUOM" SelectedValue="{Binding SelectedUOM.ID}" SelectedItem="{Binding SelectedUOM,Mode=TwoWay}" ItemsSource="{Binding UOMList}"  Margin="4" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" GotFocus="cmbPUOM_GotFocus" SelectionChanged="cmbPUOM_SelectionChanged" ></inputcombo:AutoCompleteComboBox>-->
                                                <HyperlinkButton  Content="{Binding SelectedUOM.Description,Mode=TwoWay}" Click="HyperlinkButton_Click" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="4"></HyperlinkButton>
                                            </DataTemplate>
                                        </data:DataGridTemplateColumn.CellTemplate>
                                    </data:DataGridTemplateColumn>
                                    <data:DataGridTextColumn Visibility="Visible" IsReadOnly="True"  Header="S.UOM"  Binding="{Binding SUOM,Mode=TwoWay}"></data:DataGridTextColumn>
                                    <data:DataGridTextColumn  IsReadOnly="True"  Binding="{Binding ConversionFactor, StringFormat=0.00000, Mode=TwoWay}" Header="Conversion Factor" >
                                        <data:DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="TextAlignment" Value="Right"/>
                                            </Style>
                                        </data:DataGridTextColumn.ElementStyle>
                                    </data:DataGridTextColumn>

                                    <!--End-->
                                    <data:DataGridTextColumn  IsReadOnly="True" Header="Cost Price"  Binding="{Binding Rate,StringFormat=0.00,Mode=TwoWay}">
                                        <data:DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="TextAlignment" Value="Right"/>
                                            </Style>
                                        </data:DataGridTextColumn.ElementStyle>
                                    </data:DataGridTextColumn>

                                    <data:DataGridTextColumn  IsReadOnly="True" Header="MRP"  Binding="{Binding MRP,StringFormat=0.00,Mode=TwoWay}">
                                        <data:DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="TextAlignment" Value="Right"/>
                                            </Style>
                                        </data:DataGridTextColumn.ElementStyle>
                                    </data:DataGridTextColumn>

                                    <data:DataGridTextColumn IsReadOnly="True" Header="Total Amount"  Binding="{Binding Amount,StringFormat=0.00,Mode=TwoWay}">
                                        <data:DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="TextAlignment" Value="Right"/>
                                            </Style>
                                        </data:DataGridTextColumn.ElementStyle>
                                    </data:DataGridTextColumn>
                                    <data:DataGridTemplateColumn Header="Remark">
                                        <!--<data:DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock  VerticalAlignment="Center" Text="{Binding Remark,Mode=TwoWay}" ></TextBlock>
                                            </DataTemplate>
                                        </data:DataGridTemplateColumn.CellTemplate>-->
                                        <data:DataGridTemplateColumn.CellEditingTemplate>
                                            <DataTemplate>
                                                <TextBox x:Name="txtReamrk" Text="{Binding Remark,Mode=TwoWay}" ></TextBox>
                                            </DataTemplate>
                                        </data:DataGridTemplateColumn.CellEditingTemplate>
                                    </data:DataGridTemplateColumn>


                                    <data:DataGridTemplateColumn>
                                        <data:DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <HyperlinkButton VerticalAlignment="Center" FontFamily="Webdings" Content="r"  Padding="5,0,5,0" IsTabStop="False"   x:Name="cmdDeleteItemList" Click="cmdDeleteItemList_Click" ToolTipService.ToolTip="Delete"></HyperlinkButton>
                                            </DataTemplate>
                                        </data:DataGridTemplateColumn.CellTemplate>
                                    </data:DataGridTemplateColumn>
                                </data:DataGrid.Columns>
                            </data:DataGrid>
                        </toolkit:DockPanel>
                    </toolkit:DockPanel>
                </toolkit:DockPanel>
            </toolkit:DockPanel>
        </Grid>
    </toolkit:DockPanel>
</UserControl>
