<UserControl x:Class="PalashDynamics.IPD.frmIPDBillSearch"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
              xmlns:controls="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls"
             xmlns:controlsToolkit="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Toolkit"
             xmlns:data="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Data"
             xmlns:Converter="clr-namespace:PalashDynamics.Converters;assembly=PalashDynamics.Converters" 
             xmlns:inputcombo="clr-namespace:PalashDynamics.Controls;assembly=PalashDynamics.Controls.AutoCompleteComboBox"
             xmlns:CustomCombo="clr-namespace:PalashDynamics.Controls;assembly=PalashDynamics.Controls.AutoCompleteComboBox"
    mc:Ignorable="d"
    d:DesignWidth="650" Loaded="UserControl_Loaded">
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/PalashDynamics;component/Generic.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            <Converter:DateTimeToAgePart x:Key="DateTimeToAgePart"></Converter:DateTimeToAgePart>
            <Converter:DateTimeConverter x:Key="DateConverter"></Converter:DateTimeConverter>
            <Converter:ToggleBooleanValueConverter x:Key="NegateValueConverter"/>
            <Converter:VisiblilityConverter x:Key="VisiblilityConverter"/>

            <ControlTemplate x:Key="FilledContentControlTemplate" TargetType="ContentControl" >
                <Grid>
                    <ContentPresenter />
                </Grid>
            </ControlTemplate>
        </ResourceDictionary>
    </UserControl.Resources>

    <Grid x:Name="LayoutRoot1" Background="White" >
        <controlsToolkit:DockPanel Margin="4" LastChildFill="True">
            <Border  controlsToolkit:DockPanel.Dock="Top" BorderBrush="{StaticResource TabControlDarkerBorder}"   BorderThickness="1" CornerRadius="3,3,0,0" Background="Transparent">
                <ContentControl VerticalAlignment="Center" Grid.ColumnSpan="4" FontSize="12" Content="Search Bill" Margin="-1" Style="{StaticResource Header}"     HorizontalAlignment="Stretch" />
            </Border>
            <Border BorderBrush="{StaticResource TabControlDarkerBorder}"  Margin="0,-1,0,0" BorderThickness="1" CornerRadius="0,0,3,3" Background="Transparent">
                <controlsToolkit:DockPanel Margin="4" LastChildFill="True">
                    <Grid controlsToolkit:DockPanel.Dock="Top">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"></RowDefinition>
                            <RowDefinition  Height="Auto"></RowDefinition>
                            <RowDefinition  Height="Auto"></RowDefinition>
                            <RowDefinition  Height="Auto"></RowDefinition>
                            <RowDefinition  Height="Auto"></RowDefinition>
                        </Grid.RowDefinitions>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition />
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition/>
                            <ColumnDefinition Width="Auto"/>
                         
                        </Grid.ColumnDefinitions>

                        <TextBlock Text="Clinic" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" Margin="4,4,0,4" HorizontalAlignment="Right" ></TextBlock>
                        <inputcombo:AutoCompleteComboBox   x:Name="cmbUnit" SelectedValuePath="ID" SelectedItemBinding="{Binding MasterListItem, Mode=OneWay}" TabIndex="1" Grid.Row="0" Grid.Column="1"  Margin="4"   HorizontalAlignment="Stretch"   Height="25"/>

                        <TextBlock Text="From Date" Grid.Row="0" Grid.Column="2" VerticalAlignment="Center" Margin="4" HorizontalAlignment="Right"></TextBlock>
                        <controls:DatePicker TabIndex="2" x:Name="dtpFromDate" SelectedDate="{Binding}"  Grid.Row="0" Grid.Column="3" Margin="4" HorizontalAlignment="Stretch" VerticalAlignment="Center"  SelectedDateChanged="dtpFromDate_SelectedDateChanged"></controls:DatePicker>

                        <TextBlock Text="To Date" Grid.Row="0" Grid.Column="4" VerticalAlignment="Center" Margin="4" HorizontalAlignment="Right"></TextBlock>
                        <controls:DatePicker TabIndex="3" x:Name="dtpToDate" Grid.Row="0" SelectedDate="{Binding}" Grid.Column="5" Margin="4" HorizontalAlignment="Stretch" VerticalAlignment="Center" SelectedDateChanged="dtpToDate_SelectedDateChanged" ></controls:DatePicker>




                        <TextBlock Grid.Row="1" Grid.Column="0" Text="First Name"  VerticalAlignment="Center" Margin="4,4,0,4" HorizontalAlignment="Right" ></TextBlock>
                      
                        <TextBox x:Name="txtFirstName" TabIndex="4" Grid.Row="1" Grid.Column="1" Margin="4" HorizontalAlignment="Stretch" VerticalAlignment="Center" LostFocus="txtName_LostFocus" KeyDown="txtFirstName_KeyDown" KeyUp="txtFirstName_KeyUp" TextChanged="txtFirstName_TextChanged"></TextBox>

                        <TextBlock Text="Middle Name" Grid.Row="1" Grid.Column="2" VerticalAlignment="Center" Margin="4,4,0,4" HorizontalAlignment="Right" ></TextBlock>
                      
                        <TextBox x:Name="txtMiddleName" TabIndex="5" Grid.Row="1" Grid.Column="3" Margin="4" HorizontalAlignment="Stretch" VerticalAlignment="Center" LostFocus="txtName_LostFocus" KeyDown="txtMiddleName_KeyDown" KeyUp="txtFirstName_KeyUp"  TextChanged="txtFirstName_TextChanged"></TextBox>

                        <TextBlock Text="Last Name" Grid.Row="1" Grid.Column="4" VerticalAlignment="Center" Margin="4,4,0,4" HorizontalAlignment="Right" ></TextBlock>
                       
                        <TextBox x:Name="txtLastName" Grid.Row="1" TabIndex="6" Grid.Column="5" Margin="4" HorizontalAlignment="Stretch" VerticalAlignment="Center" LostFocus="txtName_LostFocus" KeyDown="txtLastName_KeyDown" KeyUp="txtFirstName_KeyUp" TextChanged="txtFirstName_TextChanged"></TextBox>

                        <TextBlock Text="MR No" Grid.Row="2" Grid.Column="0" VerticalAlignment="Center" Margin="4,4,0,4" HorizontalAlignment="Right" ></TextBlock>
                      
                        <TextBox x:Name="txtMRNO" TabIndex="7" Grid.Row="2" Grid.Column="1" Margin="4" HorizontalAlignment="Stretch" VerticalAlignment="Center" KeyDown="txtMRNO_KeyDown"></TextBox>


                        <TextBlock Text="Bill No" Grid.Row="2" Grid.Column="2" VerticalAlignment="Center" Margin="4,4,0,4" HorizontalAlignment="Right" ></TextBlock>
                        
                        <TextBox x:Name="txtBillNO" TabIndex="8" Grid.Row="2" Grid.Column="3" Margin="4" HorizontalAlignment="Stretch" VerticalAlignment="Center" KeyDown="txtBillNO_KeyDown"></TextBox>



                        <TextBlock Text="IPD No" Grid.Row="2" Grid.Column="4" VerticalAlignment="Center" Margin="4" HorizontalAlignment="Right"></TextBlock>
                    
                        <TextBox x:Name="txtOPDNO" TabIndex="9" Grid.Row="2" Grid.Column="5" Margin="4" HorizontalAlignment="Stretch" VerticalAlignment="Center" KeyDown="txtOPDNO_KeyDown" KeyUp="txtFirstName_KeyUp" TextChanged="txtOPDNO_TextChanged"></TextBox>



                        <TextBlock Text="Bill Status" Grid.Row="3" Grid.Column="0" VerticalAlignment="Center" Margin="4,4,0,4" HorizontalAlignment="Right" ></TextBlock>
                        <inputcombo:AutoCompleteComboBox TabIndex="10"  x:Name="cmbBillStatus" SelectedValuePath="ID" SelectedItemBinding="{Binding MasterListItem, Mode=OneWay}" Grid.Row="3" Grid.Column="1"  Margin="4"   HorizontalAlignment="Stretch"   Height="25" SelectionChanged="cmbBillStatus_SelectionChanged"/>


                        <Button Grid.Row="4" Grid.Column="2" x:Name="cmdSearch" Click="cmdSearch_Click" Margin="4" ToolTipService.ToolTip="Search" HorizontalAlignment="Left" TabIndex="11" >
                            <Image Source="/PalashDynamics;component/Icons/xmag.png" Margin="2" Width="20" ></Image>
                        </Button>

                        <TextBox Grid.Row="4" Grid.Column="3" Margin="4" HorizontalAlignment="Left" VerticalAlignment="Center" Width="20" Background="Red" IsReadOnly="True" ToolTipService.ToolTip="Red"></TextBox>
                        <TextBlock Text="Unsettle Bill" Grid.Row="4" Grid.Column="3" VerticalAlignment="Center" Margin="27,4,42,4"></TextBlock>

                        <TextBox Grid.Row="4" Grid.Column="3" Margin="100,4,0,4" HorizontalAlignment="Left" VerticalAlignment="Center" Width="20" IsReadOnly="True" Background="Green" ToolTipService.ToolTip="Green" ></TextBox>
                        <TextBlock Text="Unfreezed Bill" Grid.Row="4" Grid.Column="3" VerticalAlignment="Center" Margin="125,4,0,4" HorizontalAlignment="Left" ></TextBlock>

                        <TextBlock  Grid.Row="4" Grid.Column="0"  Margin="4" VerticalAlignment="Center"  HorizontalAlignment="Left" Text="Print Format"></TextBlock>
                        <CustomCombo:AutoCompleteComboBox Grid.Row="4"  Grid.Column="1"   Margin="4"  VerticalAlignment="Center" HorizontalAlignment="Stretch"  x:Name="cmbPrintFormat" SelectedItemBinding="{Binding MasterListItem, Mode=OneWay}" SelectedValuePath="ID" ></CustomCombo:AutoCompleteComboBox>

                        <TextBlock Text="Bill Type" Grid.Row="3" Grid.Column="2" VerticalAlignment="Center" Margin="4,4,0,4" HorizontalAlignment="Right" ></TextBlock>
                        <inputcombo:AutoCompleteComboBox   x:Name="cmbBillTypeClPh" SelectedValuePath="ID" SelectedItemBinding="{Binding MasterListItem, Mode=OneWay}" Grid.Row="3" Grid.Column="3"  Margin="4"   HorizontalAlignment="Stretch"   Height="25"/>

                        <TextBlock Text="OPD/IPD" Grid.Row="3" Grid.Column="4" VerticalAlignment="Center" Margin="4,4,0,4" HorizontalAlignment="Right" Visibility="Collapsed" ></TextBlock>
                        <inputcombo:AutoCompleteComboBox   x:Name="cmbIPDOPD" SelectedValuePath="ID" SelectedItemBinding="{Binding MasterListItem, Mode=OneWay}" Grid.Row="3" Grid.Column="5"  Margin="4"   HorizontalAlignment="Stretch" SelectionChanged="cmbIPDOPD_SelectionChanged"  Height="25" Visibility="Collapsed"/>

                    </Grid>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition></RowDefinition>

                        </Grid.RowDefinitions>
                        <controlsToolkit:DockPanel Margin="4" LastChildFill="True" Grid.Row="0">
                       
                            <data:DataPager x:Name="dgDataPager" controlsToolkit:DockPanel.Dock="Bottom" 
                                                        DisplayMode="FirstLastPreviousNext"  IsEnabled="True"                       
                                                        Source="{Binding}" 
                                                        AutoEllipsis="False" IsTotalItemCountFixed="False"  />
                            <data:DataGrid  x:Name="dgBillList" Margin="0,0,0,1" ItemsSource="{Binding}"  AutoGenerateColumns="False"  SelectionChanged="dgBillList_SelectionChanged" LoadingRow="dgBillList_LoadingRow">
                                <data:DataGrid.Columns >                                    

                                    <data:DataGridTemplateColumn>
                                        <data:DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <HyperlinkButton Background="White"  VerticalAlignment="Center" Padding="5,0,5,0" IsTabStop="False" Click="btnPrint_Click"   Visibility="{Binding IsFreezed, Converter={StaticResource VisiblilityConverter}}" x:Name="btnPrint" >
                                                    <Image  Height="16" Stretch="Fill" Source="/PalashDynamics;component/Icons/Print_32.png"  />
                                                </HyperlinkButton>
                                            </DataTemplate>
                                        </data:DataGridTemplateColumn.CellTemplate>

                                    </data:DataGridTemplateColumn>

                                    <data:DataGridTextColumn Binding="{Binding Date,Mode=OneWay,Converter={StaticResource DateConverter},ConverterParameter={StaticResource GridDateDisplayFormat}}"  Header="Date" IsReadOnly="True" />
                                    <data:DataGridTextColumn Binding="{Binding BillNo, Mode=OneWay}" Header="Bill No." IsReadOnly="True"/>
                                    <data:DataGridTextColumn Binding="{Binding MRNO, Mode=OneWay}" Header="MR No." IsReadOnly="True"/>
                                    <data:DataGridTextColumn Binding="{Binding IPDNO,Mode=OneWay}"  Header="IPD No" IsReadOnly="True" />
                                    <data:DataGridTemplateColumn IsReadOnly="True" Header="Name" Width="150" SortMemberPath="FirstName">
                                        <data:DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                                                    <TextBlock VerticalAlignment="Center" Text="{Binding FirstName}" Margin="4,0,4,0"></TextBlock>
                                                    <TextBlock VerticalAlignment="Center" Text="{Binding MiddleName}" Margin="0,0,4,0"></TextBlock>
                                                    <TextBlock VerticalAlignment="Center" Text="{Binding LastName}"></TextBlock>
                                                </StackPanel>
                                            </DataTemplate>
                                        </data:DataGridTemplateColumn.CellTemplate>
                                    </data:DataGridTemplateColumn>
                                    <data:DataGridTextColumn Binding="{Binding TotalBillAmount, StringFormat=0.00,Mode=OneWay}"  Header="Total Amount" IsReadOnly="True">
                                        <data:DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="TextAlignment" Value="Right"/>
                                            </Style>
                                        </data:DataGridTextColumn.ElementStyle>
                                    </data:DataGridTextColumn>

                                    <data:DataGridTextColumn Binding="{Binding TotalConcessionAmount, StringFormat=0.00,Mode=OneWay}"  Header="Total Concession" IsReadOnly="True">
                                        <data:DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="TextAlignment" Value="Right"/>
                                            </Style>
                                        </data:DataGridTextColumn.ElementStyle>
                                    </data:DataGridTextColumn>
                                    <data:DataGridTextColumn Binding="{Binding NetBillAmount, StringFormat=0.00,Mode=OneWay}"  Header="Net Amount" IsReadOnly="True" >
                                        <data:DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="TextAlignment" Value="Right"/>
                                            </Style>
                                        </data:DataGridTextColumn.ElementStyle>
                                    </data:DataGridTextColumn>


                                    <data:DataGridTextColumn Binding="{Binding PaidAmountSelf, StringFormat=0.00,Mode=OneWay}"  Header="Paid Amount" IsReadOnly="True" >
                                        <data:DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="TextAlignment" Value="Right"/>
                                            </Style>
                                        </data:DataGridTextColumn.ElementStyle>
                                    </data:DataGridTextColumn>

                                    <data:DataGridTextColumn Binding="{Binding BalanceAmountSelf, StringFormat=0.00,Mode=OneWay}"  Header="Balance Amount" IsReadOnly="True" >
                                        <data:DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="TextAlignment" Value="Right"/>
                                            </Style>
                                        </data:DataGridTextColumn.ElementStyle>
                                    </data:DataGridTextColumn>

                                    <data:DataGridTemplateColumn Header="Freezed" IsReadOnly="True">
                                        <data:DataGridTemplateColumn.CellTemplate >
                                            <DataTemplate >
                                                <CheckBox ToolTipService.ToolTip="Please Freezed Bill." Margin="10,2,10,2" IsChecked="{Binding IsFreezed,Mode=TwoWay}"  IsEnabled="False"  VerticalAlignment="Center" HorizontalAlignment="Center" Click="CheckBox_Click"  ></CheckBox >
                                            </DataTemplate>
                                        </data:DataGridTemplateColumn.CellTemplate>
                                    </data:DataGridTemplateColumn>

                                    <data:DataGridTemplateColumn Header="" IsReadOnly="True" >
                                        <data:DataGridTemplateColumn.CellTemplate  >
                                            <DataTemplate >
                                                
                                                <HyperlinkButton ToolTipService.ToolTip="Please Settle Bill." VerticalAlignment="Center" Padding="5,0,5,0" Margin="4"  IsTabStop="False" Click="btnSettle_Click" x:Name="btnSettle" HorizontalAlignment="Center"  Content="Settle Bill"></HyperlinkButton>
                                              
                                            </DataTemplate>
                                        </data:DataGridTemplateColumn.CellTemplate>
                                    </data:DataGridTemplateColumn>

                                    <data:DataGridTemplateColumn>
                                        <data:DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <HyperlinkButton VerticalAlignment="Center" Padding="5,0,5,0" IsTabStop="False" Click="btnReceipt_Click"   x:Name="btnReceipt" Content="Receipts">
                                                  
                                                </HyperlinkButton>
                                            </DataTemplate>
                                        </data:DataGridTemplateColumn.CellTemplate>
                                    </data:DataGridTemplateColumn>
                                </data:DataGrid.Columns>
                            </data:DataGrid>
                        </controlsToolkit:DockPanel>

                    </Grid>
                </controlsToolkit:DockPanel>
            </Border>
        </controlsToolkit:DockPanel>
    </Grid>

</UserControl>